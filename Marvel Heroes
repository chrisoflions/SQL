/* Put your data in here and query it! */

/* Marvel Heroes
 Based on the website http://marvel.wikia.com/Main_Page
 with popularity data from https://www.ranker.com/crowdranked-list/top-marvel-comics-superheroes 
 and power grid data from http://marvel.wikia.com/Power_Grid#Power
 */

CREATE TABLE marvels (ID INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT,
    popularity INTEGER,
    alignment TEXT,
    gender TEXT, 
    height_m NUMERIC,
    weight_kg NUMERIC,
    hometown TEXT,
    intelligence INTEGER,
    strength INTEGER,
    speed INTEGER,
    durability INTEGER,
    energy_Projection INTEGER,
    fighting_Skills INTEGER);
    
INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Spider-Man (Peter Parker)", 1, "Good", "Male", 1.78, 75.75, "USA", 4, 4, 3, 3, 1, 4); 
INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Iron Man", 5, "Good", "Male", 1.98, 102.58, "USA", 6, 6, 5, 6, 6, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Hulk", 7, "Neutral", "Male", 2.44, 635.29, "USA", 1, 7, 3, 7, 5, 4); 

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Wolverine", 6, "Good", "Male", 1.6, 88.46, "Canada", 2, 4, 2, 4, 1, 7);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Thor", 3, "Good", "Male", 1.98, 290.3, "Asgard", 2, 7, 7, 6, 6, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Rocket Raccoon", 15, "Good", "Male", 1.22, 24.95, "Halfworld", 3, 2, 2, 2, 1, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Daredevil", 26, "Good", "Male", 1.80, 83.91, "USA", 3, 3, 2, 2, 4, 5);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Human Torch", 31, "Good", "Male", 1.78, 77.11, "USA", 2, 2, 5, 6, 5, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Loki", 100, "Neutral", "Male", 1.93, 238.14, "Jotunheim", 5, 5, 7, 6, 6, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Adam Warlock", 65, "Neutral", "Male", 1.88, 108.86, "Beehive", 3, 5, 7, 6, 6, 2);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Mr. Fantastic", 61, "Good", "Male", 1.85, 81.65, "USA", 6, 2, 2, 5, 1, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Invisible Woman", 58, "Good", "Female", 1.68, 54.43, "USA", 3, 2, 3, 6, 5, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Storm", 29, "Good", "Female", 1.80, 66, "Kenya", 2, 2, 3, 2, 5, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Nightcrawler", 23, "Good", "Male", 1.75, 73, "Germany", 3, 2, 7, 2, 1, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Gambit", 22, "Good", "Male", 1.88, 81, "EUA", 2, 2, 2, 2, 2, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Captain America", 8, "Good", "Male", 1.88, 108, "USA", 3, 3, 2, 3, 1, 6);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Cyclops", 54, "Good", "Male", 1.90, 88, "USA", 3, 2, 2, 2, 5, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Gamora", 44, "Good", "Female", 1.83, 77, "Zen-Whoberi", 3, 3, 4, 3, 1, 6);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Peggy Carter", 90, "Good", "Female", 1.65, 45.81, "United Kingdom", 3, 2, 2, 2, 1, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Star-Lord", 14, "Good", "Male", 1.88, 79.38, "USA", 4, 3, 2, 3, 1, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Punisher", 18, "Neutral", "Male", 1.85, 91, "USA", 3, 3, 2, 2, 1, 6);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Silver Surfer", 17, "Good", "Male", 1.93, 102, "Zenn-La", 3, 7, 7, 6, 7, 2);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Groot", 86, "Good", "Male", 7.01, 3719, "Planet X", 3, 7, 3, 4, 3, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Ant-Man (Scott Lang)", 13, "Good", "Male", 1.83, 86.18, "USA", 4, 5, 3, 5, 3, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Namor the Submariner", 89, "Neutral", "Male", 1.88, 278, "Atlantis", 2, 6, 3, 6, 2, 4);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Deadpool", 4, "Neutral", "Male", 1.88, 95, "Canada", 2, 4, 2, 4, 1, 6);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Spider-Man (Miles Morales)", 19, "Good", "Male", 1.73, 72.57, "USA", 2, 4, 3, 3, 2, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Hawkeye (Kate Bishop)", 93, "Good", "Female", 1.65, 54.43, "USA", 3, 2, 2, 2, 1, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Black Panther (T'Challa)", 10, "Good", "Male", 1.83, 90.72, "Wakanda", 5, 3, 2, 3, 3, 5);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Black Knight (Dane Whitman)", 108, "Good", "Male", 1.83, 86.18, "USA", 4, 2, 2, 5, 4, 5);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Professor X", 20, "Good", "Male", 1.83, 86.18, "USA", 5, 2, 2, 2, 5, 3);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Winter Soldier (Bucky Barnes)", 30, "Neutral", "Male", 1.75, 117.93, "USA", 2, 4, 2, 4, 1, 6);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Thing", 34, "Good", "Male", 1.83, 226.8, "USA", 3, 6, 2, 6, 1, 5);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Doctor Strange", 2, "Good", "Male", 1.88, 81.65, "USA", 4, 2, 7, 2, 6, 6);

INSERT INTO marvels(name, popularity, alignment, gender, height_m, weight_kg, hometown, intelligence, strength, speed, durability, energy_Projection, fighting_skills) VALUES("Black Widow (Natasha Romanoff)", 11, "Neutral", "Female", 1.7, 59.42, "Russia", 3, 3, 2, 3, 3, 6);

SELECT * FROM marvels;

SELECT * FROM marvels WHERE gender LIKE "female" AND fighting_skills >=3;

SELECT * FROM marvels WHERE intelligence >=4 AND popularity < 20;

SELECT name, AVG (height_m) AS average_height FROM marvels
    GROUP BY name
    HAVING height_m <= 1.8
    ;

SELECT name, MAX (strength) AS strongest_heroes FROM marvels
    GROUP BY name
    HAVING strength >= 6
    ;
    
SELECT name, MAX (intelligence) AS smartest_heroes FROM marvels
    GROUP BY name
    HAVING intelligence >= 5
    ;
SELECT name FROM marvels WHERE alignment = "Neutral";

SELECT * FROM marvels
    GROUP BY name;

SELECT name, fighting_skills, intelligence, energy_Projection,
    CASE
        WHEN fighting_skills >= 5 THEN "Elite Fighters"
        WHEN intelligence >= 6 THEN "Smartest Heroes"
        WHEN energy_projection >= 4 THEN "Energy Projectile Heroes"
        ELSE "Other"
    END as "Hero Groups"
FROM marvels;
